<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Planner - Validation Tests</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            background: #f9fafb;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #6b7280;
            margin-bottom: 2rem;
        }

        .test-section {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e5e7eb;
        }

        .test-section h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #1f2937;
        }

        .test-case {
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid #e5e7eb;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }

        .test-case.pass {
            background-color: #d1fae5;
            border-color: #10b981;
        }

        .test-case.fail {
            background-color: #fee2e2;
            border-color: #ef4444;
        }

        .test-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .test-input {
            color: #4b5563;
            margin-bottom: 0.25rem;
        }

        .test-result {
            color: #059669;
            font-weight: 500;
        }

        .test-case.fail .test-result {
            color: #dc2626;
        }

        .stats {
            background: #3b82f6;
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-around;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        code {
            background: #f3f4f6;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
        }
    </style>
</head>
<body>
    <h1>Regex Validation Tests</h1>
    <p class="subtitle">Testing all validation patterns for Campus Life Planner</p>

    <div class="stats">
        <div class="stat">
            <div class="stat-value" id="totalTests">0</div>
            <div class="stat-label">Total Tests</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="passedTests">0</div>
            <div class="stat-label">Passed</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="failedTests">0</div>
            <div class="stat-label">Failed</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="passRate">0%</div>
            <div class="stat-label">Pass Rate</div>
        </div>
    </div>

    <div id="testResults"></div>

    <script type="module">
        // Import validators
        import { validators, validateField } from './scripts/validators.js';

        const testResults = document.getElementById('testResults');
        let totalTests = 0;
        let passedTests = 0;

        function runTest(sectionName, testName, value, expectedValid, validatorName) {
            totalTests++;
            const result = validateField(validatorName, value);
            const passed = result.valid === expectedValid;
            
            if (passed) passedTests++;

            return {
                name: testName,
                input: value,
                expected: expectedValid ? 'Valid' : 'Invalid',
                actual: result.valid ? 'Valid' : 'Invalid',
                message: result.message,
                passed
            };
        }

        function renderSection(title, tests) {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = `
                <h2>${title}</h2>
                ${tests.map(test => `
                    <div class="test-case ${test.passed ? 'pass' : 'fail'}">
                        <div class="test-label">${test.name}</div>
                        <div class="test-input">Input: "${test.input}"</div>
                        <div class="test-result">
                            ${test.passed ? '✓' : '✗'} 
                            Expected: ${test.expected}, Got: ${test.actual}
                            ${test.message ? ` - ${test.message}` : ''}
                        </div>
                    </div>
                `).join('')}
            `;
            testResults.appendChild(section);
        }

        // Run all tests
        const titleTests = [
            runTest('Title', 'Valid title', 'Complete Assignment', true, 'title'),
            runTest('Title', 'Title with spaces', 'Study for Exam', true, 'title'),
            runTest('Title', 'Leading space (invalid)', ' Complete Assignment', false, 'title'),
            runTest('Title', 'Trailing space (invalid)', 'Complete Assignment ', false, 'title'),
            runTest('Title', 'Empty string (invalid)', '', false, 'title'),
            runTest('Title', 'Only spaces (invalid)', '   ', false, 'title'),
        ];

        const durationTests = [
            runTest('Duration', 'Valid number', '120', true, 'duration'),
            runTest('Duration', 'Zero', '0', true, 'duration'),
            runTest('Duration', 'Large number', '9999', true, 'duration'),
            runTest('Duration', 'Decimal (invalid)', '120.5', false, 'duration'),
            runTest('Duration', 'Negative (invalid)', '-5', false, 'duration'),
            runTest('Duration', 'Text (invalid)', 'abc', false, 'duration'),
        ];

        const dateTests = [
            runTest('Date', 'Valid date', '2025-10-20', true, 'date'),
            runTest('Date', 'January date', '2025-01-15', true, 'date'),
            runTest('Date', 'December date', '2025-12-31', true, 'date'),
            runTest('Date', 'Invalid format (invalid)', '20-10-2025', false, 'date'),
            runTest('Date', 'Invalid month (invalid)', '2025-13-20', false, 'date'),
            runTest('Date', 'Invalid day (invalid)', '2025-10-32', false, 'date'),
            runTest('Date', 'Wrong separator (invalid)', '2025/10/20', false, 'date'),
        ];

        const tagTests = [
            runTest('Tag', 'Single word', 'Assignment', true, 'tag'),
            runTest('Tag', 'Two words with space', 'Study Session', true, 'tag'),
            runTest('Tag', 'Words with hyphen', 'Mid-Term', true, 'tag'),
            runTest('Tag', 'Multiple words', 'Group Study Session', true, 'tag'),
            runTest('Tag', 'Leading space (invalid)', ' Assignment', false, 'tag'),
            runTest('Tag', 'Numbers (invalid)', 'Assignment123', false, 'tag'),
            runTest('Tag', 'Special chars (invalid)', 'Assignment!', false, 'tag'),
        ];

        const advancedTests = [
            {
                name: 'Duplicate word detection',
                input: 'the the assignment',
                expected: 'Valid (contains duplicate)',
                actual: validators.duplicateWord.regex.test('the the assignment') ? 'Valid (contains duplicate)' : 'Invalid',
                passed: validators.duplicateWord.regex.test('the the assignment'),
                message: 'Detects "the the" using back-reference'
            },
            {
                name: 'No duplicate words',
                input: 'complete the assignment',
                expected: 'Invalid (no duplicates)',
                actual: !validators.duplicateWord.regex.test('complete the assignment') ? 'Invalid (no duplicates)' : 'Valid',
                passed: !validators.duplicateWord.regex.test('complete the assignment'),
                message: 'No consecutive duplicates found'
            },
            {
                name: 'Time token detection',
                input: 'Meeting at 14:30',
                expected: 'Valid (contains time)',
                actual: validators.timeToken.regex.test('Meeting at 14:30') ? 'Valid (contains time)' : 'Invalid',
                passed: validators.timeToken.regex.test('Meeting at 14:30'),
                message: 'Detects HH:MM format using \\d{2}:\\d{2}'
            },
            {
                name: 'No time token',
                input: 'Regular meeting',
                expected: 'Invalid (no time)',
                actual: !validators.timeToken.regex.test('Regular meeting') ? 'Invalid (no time)' : 'Valid',
                passed: !validators.timeToken.regex.test('Regular meeting'),
                message: 'No time pattern found'
            },
        ];

        totalTests += advancedTests.length;
        passedTests += advancedTests.filter(t => t.passed).length;

        // Render all test sections
        renderSection('Title Validation (Pattern: /^\\S(?:.*\\S)?$/)', titleTests);
        renderSection('Duration Validation (Pattern: /^(0|[1-9]\\d*)$/)', durationTests);
        renderSection('Date Validation (Pattern: /^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$/)', dateTests);
        renderSection('Tag Validation (Pattern: /^[A-Za-z]+(?:[ -][A-Za-z]+)*$/)', tagTests);
        renderSection('Advanced Regex (Back-references & Lookahead)', advancedTests);

        // Update stats
        document.getElementById('totalTests').textContent = totalTests;
        document.getElementById('passedTests').textContent = passedTests;
        document.getElementById('failedTests').textContent = totalTests - passedTests;
        document.getElementById('passRate').textContent = Math.round((passedTests / totalTests) * 100) + '%';
    </script>
</body>
</html>
